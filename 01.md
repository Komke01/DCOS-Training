# 00 Breaking Ice

IT solutions constantly feel like: https://youtu.be/C2YZnTL596Q?t=46s
But ever so often, we do make a leap that allows us to deal with problems of a higher order.

From dedicated boxes and expensive data centers to virtualization and now to containers and container management. We constantly evolve new ways of doing our job better.

We are here to grok the basics of a bunch of overlapping technologies.
This may be confusing to start with, so we'll focus on a lot of hands on sessions.

This is in no way a comprehensive survey of the field, nor is it a extremely deep dive into the inner workings of distributed computing, datacenters etc. 
The goal is to familiarize you with these technologies and give you a solid grounding on Mesos and DC/OS.

Each new technology 'trend' must be taken with a grain of salt, a technology that worked well for one type of solution may not work for another. Our sessions here *may* give you some insights into how to make this decision as well.

# 01 Install Dependencies
* Ensure that virtualization is enabled on your desk/laptops
* Ensure the following are installed
    * Docker
    * Mingw or Cygwin
    * Git
    * Vagrant
    * others as necessary

* for all config files and others, make sure that you use unix style line ending in Notepad++

# 02 Why Mesos, DC/OS?
* cluster manager
* two level scheduler
* support for long running jobs
* 

## Outline
* Configuration Management and the problems with scale
* Distributed computing
* Virtualization
* Isolation through containerization
* Linux containers are lightweight and fast
* Microservices
* Container lifecycle management
* Container use cases - for development and deployment
* Build - Ship - Deploy
* Mesos works with containers from the ground up
    * does for containers what windows does for .exe and .dll files
* DC/OS builds on top of Mesos to provide capabilities for managing an entire datacenter
    * uses a YAML based configuration file on top of Vagrant


# 03 Vagrant Up
## Why?

* Virtualization technology, while very valuable, adds a lot of variables to the mix
	* which provider?
	* what capabilities?
	* how to account for a change in the CLI or API of a provider?
* Configuring just the right virtual environment becomes a big ask
* Enter Vagrant
	* allowing one to truly automate the tasks of setup, start/pause and teardown of disposable virtual environments

## ...and What?
* tool for building and managing virtual machine environments
* supports multiple:
	* Providers - infrastructure providers like VirtualBox, VMWare, AWS etc.
	* Provisioning tools - configuration management tools like Chef, Puppet etc.
* enables environments (entire virtual machines) that are:
	* configurable in a consistent, unified workflow
	* reproducible
	* portable

### Aside: Vagrant and Docker

* *Vagrant* is a *workflow tool* for setting up virtual environments in a consistent manner. It provides a wrapper on top of the CLI provided by the various vitual environment hosts.
* *Docker* is a *container management* tool - containers are very lightweight, so starting and stopping them is more efficient, this is really attractive for microservices scenarios. Later we'll see how one can use the docker provider with Vagrant.

### Vagrant vocabulary

* Boxes - Package format for the Vagrant environment. Just like a 'class' in Object oriented programming. One just needs a box to consistently bring any environment up.

* Provisioners - allow one to automatically install software, alter configurations, and more on the machine as part of the vagrant up process. 
	* Provisioners are available for Chef, Puppet, Ansible, Docker etc.

* Synced folders -  enable Vagrant to sync a folder on the host machine to the guest machine. This allows you to continue working on your project's files on your host machine, but use the resources in the guest machine to compile or run your project. By default, Vagrant will share your project directory (the directory with the Vagrantfile) to /vagrant. We will use a type of synced folders __type: "smb"__ to work with synced folders on Windows.

* Multi-machine - allows one to setup multiple machine environments - such as a database and a web server. 


## How? - Hands On: Vagrant
Let's try our hand at Vagrant so we build a fair level of comfort with the technology. In future, this will give us insights into DC/OS and will also give us a good grounding for installing a small DC/OS cluster on our local machines.
Please follow along closely and ensure that you complete all the steps. 

* To use Vagrant, one simply needs to create a VagrantFile and call vagrant up. Everything is installed and configured for you to work, consistently. 

* To create a sample VagrantFile, run:

```shell
vagrant init
```

* **precise*32*** and **precise*64*** are very commonly used boxes.

* Let's add the precise32 box, to do so run:
```shell
vagrant box add hashicorp/precise32
```
	* Vagrant will download the box to your machine

* Let's now modify the VagrantFile, so it picks up this new box:

``` shell
VAGRANTFILE_API_VERSION = "2"
Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
  config.vm.box = "hashicorp/precise32"
  end
```
* notice how the do is really assigning a variable name to a complex object in the code above.
* You can explore other boxes on the Hashicorp Atlas, which serves as a registry of boxes: https://atlas.hashicorp.com/boxes/search

* Now we can start the VM by using:

```shell
vagrant up
```

* To 'pause' the VM, run:
```shell
vagrant suspend
```
* To resume again, run:
```shell
vagrant resume
```

* To shut down the VM completely, run:
```shell
vagrant halt
```

* To shut down the VM completely and destroy all resources that were created during machine creation, run
```shell
vagrant destroy
```



using a docker provider with Vagrant.

# 04 Hands On: Setup a DC/OS cluster locally
We'll use: https://github.com/dcos/dcos-vagrant/

Install the vagrant hostmanager plugin: 

```shell
vagrant plugin install vagrant-hostmanager
```


